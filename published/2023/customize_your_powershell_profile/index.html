<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Introduction A PowerShell profile is a script that runs every time you start PowerShell and allows you to configure various aspects of your shell environment."><meta property="og:title" content="Customize Your PowerShell Profile"><meta property="og:description" content="Introduction A PowerShell profile is a script that runs every time you start PowerShell and allows you to configure various aspects of your shell environment."><meta property="og:type" content="website"><meta property="og:image" content="https://blog.griff.systems/icon.png"><meta property="og:url" content="https://blog.griff.systems/published/2023/customize_your_powershell_profile/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="Customize Your PowerShell Profile"><meta name=twitter:description content="Introduction A PowerShell profile is a script that runs every time you start PowerShell and allows you to configure various aspects of your shell environment."><meta name=twitter:image content="https://blog.griff.systems/icon.png"><title>Customize Your PowerShell Profile</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://blog.griff.systems//icon.png><link href=https://blog.griff.systems/styles.80333fa2099c0bee674efa435fde378c.min.css rel=stylesheet><link href=https://blog.griff.systems/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://blog.griff.systems/js/darkmode.c869d3a61240a800a16e2c2547d7ba0e.min.js></script>
<script src=https://blog.griff.systems/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://blog.griff.systems/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://blog.griff.systems/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://blog.griff.systems/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://blog.griff.systems/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://blog.griff.systems/",fetchData=Promise.all([fetch("https://blog.griff.systems/indices/linkIndex.936f25950107e272fe15dc2273f0a64f.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://blog.griff.systems/indices/contentIndex.b53eca8188eec68b1f1a854c154b2ed5.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://blog.griff.systems",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://blog.griff.systems",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=()=>{addCopyButtons(),addTitleToCodeBlocks()}</script><script type=module>
    import { attachSPARouting } from "https:\/\/blog.griff.systems\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=blog.griff.systems src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://blog.griff.systems/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://blog.griff.systems/>blog.griff.systems</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Customize Your PowerShell Profile</h1><p class=meta>Last updated
Nov 19, 2023</p><ul class=tags><li><a href=https://blog.griff.systems/tags/Terminal/>Terminal</a></li><li><a href=https://blog.griff.systems/tags/TerminalTipTuesday/>Terminal tip tuesday</a></li><li><a href=https://blog.griff.systems/tags/powershell/>Powershell</a></li><li><a href=https://blog.griff.systems/tags/profiles/>Profiles</a></li><li><a href=https://blog.griff.systems/tags/customization/>Customization</a></li></ul><a href=#introduction><h1 id=introduction><span class=hanchor arialabel=Anchor></span>Introduction</h1></a><p>A PowerShell profile is a script that runs every time you start PowerShell and allows you to configure various aspects of your shell environment. You can use it to change the appearance of your console, pre-load modules and scripts, create aliases and functions, and more. By creating your own PowerShell profile, you can tailor PowerShell to your preferences and needs. In the following sections, I will explain how to create a PowerShell profile and how to customize it to your liking.</p><a href=#what-is-a-profile><h1 id=what-is-a-profile><span class=hanchor arialabel=Anchor></span>What is a Profile?</h1></a><p>A PowerShell profile is a script that runs when PowerShell starts. You can use the profile as a startup script to customize your environment. You can add commands, aliases, functions, variables, modules, PowerShell drives and more. You can also add other session-specific elements to your profile so they’re available in every session without having to import or re-create them. PowerShell supports several profiles for users and host programs. However, it doesn’t create the profiles for you. You need to create the profile files and directories manually or by using a command.</p><a href=#locating-your-profile><h1 id=locating-your-profile><span class=hanchor arialabel=Anchor></span>Locating your Profile</h1></a><p>Your profile is most likely stored in your user profile&rsquo;s Documents directory, in the WindowsPowerShell directory:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$env:userprofile</span><span class=p>)</span><span class=s2>\Documents\WindowsPowerShell\&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>You can check to see if you already have profile script using this command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Test-Path</span> <span class=n>-Path</span> <span class=nv>$Profile</span>
</span></span></code></pre></td></tr></table></div></div><p>If for some reason this returns <code>False</code>, you can create your profile script with this command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>New-Item</span> <span class=n>-Path</span> <span class=nv>$Profile</span> <span class=n>-Type</span> <span class=n>File</span> <span class=n>-Force</span>
</span></span></code></pre></td></tr></table></div></div><p>There are different profiles for different console hosts, so if you do a lot of work in another application such as VS Code, PowerShell ISE, etc. then you may have or need multiple profiles which contain configuration specific to those hosts. The good news is that they are typically stored in the same location as your standard profile, and you can edit them similarly.</p><a href=#my-profile><h1 id=my-profile><span class=hanchor arialabel=Anchor></span>My Profile</h1></a><p>Here is a screenshot of Windows Terminal using one of my profiles at first load:</p><p><img src="//Pasted image 20231119105720.png" width=auto></p><p>And here is a screenshot of the in-terminal editor that I use for when I just need to do some quick text editing or modify a config file and don&rsquo;t need VS Code for scripting:</p><p><img src="//Pasted image 20231119110042.png" width=auto></p><p>Looks pretty slick! So let&rsquo;s take a look at how you can create yourself a comfortable and customized PowerShell environment.</p><a href=#customizing-your-profile><h1 id=customizing-your-profile><span class=hanchor arialabel=Anchor></span>Customizing your Profile</h1></a><p>Ultimately your profile can be edited via any means you&rsquo;d use to edit a text file. You can browse to the location printed to the terminal when you use <code>$profile</code> and open that file in your favorite editor. This might be something as simple and native as Notepad, something easy and third-party like the revered Notepad++, or a flow-blown ISE such as VS Code. If you have Vim or Nano installed on your system, you can also use that to edit your profile directly in your terminal with <code>vim $profile</code> or <code>nano $profile</code> (this is my preferred method, but use whichever way works best for you)!</p><a href=#customize-your-color-scheme><h2 id=customize-your-color-scheme><span class=hanchor arialabel=Anchor></span>Customize your Color Scheme</h2></a><p>Your terminal emulator of choice may already have inbuilt options for changing the color scheme. Windows Terminal, ConEmu, and Termius all have this functionality. The inbuilt Windows PowerShell console host allows you to manually change its colors, but does not offer inbuilt color scheme presets.</p><p>Some time ago, Microsoft released the
<a href=https://devblogs.microsoft.com/commandline/introducing-the-windows-console-colortool/ rel=noopener>ColorTool</a> on their Windows Terminal GitHub repository. This provides a simple way of setting the color scheme of your terminal if you don&rsquo;t have access to a terminal emulator that offers easy color scheme presets.</p><p>Download the latest release from their GitHub repository, extract it, and place the <code>ColorTool</code> directory somewhere safe that won&rsquo;t get deleted, you have permissions to, etc. Inside the directory is the executable as well as a directory with some color schemes in it. ColorTool supports <code>.itermcolors</code> files so you can add your own if you don&rsquo;t like one of the default ones.</p><p>To set your color scheme once, you can use this command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Start-Process</span> <span class=n>-Path</span> <span class=s2>&#34;C:\Path\to\ColorTool.exe&#34;</span> <span class=n>-Arguments</span> <span class=s2>&#34;OneHalfDark.itermcolors&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>You could take it a step further and add this to your profile script if you wanted to make sure your color scheme is always set as you desire.</p><a href=#customize-your-font><h2 id=customize-your-font><span class=hanchor arialabel=Anchor></span>Customize your Font</h2></a><p>Most terminal emulators will offer some kind of fonts options, most often supporting most of the default fonts installed on your system, so pick one you like if you don&rsquo;t like the default Consolas or other font. I highly recommend a monospaced font for your terminal.</p><p>If you want to take it a step further, you can install a special Nerd Font which adds support for a variety of other characters in the terminal. Check out
<a href=https://www.nerdfonts.com/ rel=noopener>Nerd Fonts</a> and see what&rsquo;s available that suits your needs and wishes!</p><p>I personally am just using a font called
<a href=https://madmalik.github.io/mononoki/ rel=noopener>Mononoki NF</a>.</p><a href=#customize-your-shell-prompt><h2 id=customize-your-shell-prompt><span class=hanchor arialabel=Anchor></span>Customize your Shell Prompt</h2></a><p>The fastest way to customize your shell prompt without any dependencies is to write your own prompt in your profile by modifying the <code>prompt</code> function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=c># Custom shell prompt for Windows PowerShell profile</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=n>prompt</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;[</span><span class=p>$(</span><span class=nb>Get-Date</span> <span class=n>-format</span> <span class=s1>&#39;hh:mm:ss tt&#39;</span><span class=p>)</span><span class=s2>] PS </span><span class=p>$(</span><span class=nv>$executionContext</span><span class=p>.</span><span class=n>SessionState</span><span class=p>.</span><span class=n>Path</span><span class=p>.</span><span class=n>CurrentLocation</span><span class=p>)$(</span><span class=s1>&#39;&gt;&#39;</span> <span class=p>*</span> <span class=p>(</span><span class=nv>$nestedPromptLevel</span> <span class=p>+</span> <span class=n>1</span><span class=p>))</span><span class=s2> &#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>This will change your prompt to include the time and look more like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[08:30:28] PS C:\Users\griff &gt;
</span></span></code></pre></td></tr></table></div></div><a href=#using-ohmyposh-for-easy-customization><h2 id=using-ohmyposh-for-easy-customization><span class=hanchor arialabel=Anchor></span>Using OhMyPosh for Easy Customization</h2></a><p>We can take care of customizing the theme and shell prompt simultaneously using the Oh My Posh prompt theme engine.</p><p>You can install OhMyPosh several ways:</p><ul><li>Run <code>winget install JanDeDobbeleer.OhMyPosh -s winget</code> in PowerShell</li><li>If you use the Scoop package manager, you can run <code>scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json</code> in PowerShell</li><li>Install from the Microsoft Store</li></ul><p>Once you have it installed, you can select a theme from their [themes page]((
<a href=https://ohmyposh.dev/docs/themes%29 rel=noopener>https://ohmyposh.dev/docs/themes)</a>. Once you&rsquo;ve picked a theme, you&rsquo;ll want to edit your PowerShell profile to utilize the theme. You can point the <code>oh-my-posh</code> command at the URL of the theme&rsquo;s configuration, or you can download that configuration and point <code>oh-my-posh</code> at the local file.</p><p>Using local path:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>oh-my</span><span class=n>-posh</span> <span class=n>init</span> <span class=n>pwsh</span> <span class=p>-</span><span class=n>-config</span> <span class=s1>&#39;C:\Users\griff\jandedobbeleer.omp.json&#39;</span> <span class=p>|</span> <span class=nb>Invoke-Expression</span>
</span></span></code></pre></td></tr></table></div></div><p>Using online URL:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>oh-my</span><span class=n>-posh</span> <span class=n>init</span> <span class=n>pwsh</span> <span class=p>-</span><span class=n>-config</span> <span class=s1>&#39;https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/jandedobbeleer.omp.json&#39;</span> <span class=p>|</span> <span class=nb>Invoke-Expression</span>
</span></span></code></pre></td></tr></table></div></div><p>If you want to download an online theme locally, you can use this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=s1>&#39;https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/jandedobbeleer.omp.json&#39;</span> <span class=n>-OutFile</span> <span class=s1>&#39;C:\Users\griff\jandedobbeleer.omp.json&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>And then you can use that local path in your configuration. Once you&rsquo;ve added one of the above commands to your profile, save it and close/re-open your terminal, and you should see your newly themed shell prompt!</p><p>Be sure to check out the Oh My Posh documentation which is linked in the Additional Resources section of this blog post to learn about getting started in detail, and see all of the neat things you can do with it!</p><p>I&rsquo;m using the Pure theme in the screenshots at the beginning of this post.</p><a href=#add-aliases-and-functions><h1 id=add-aliases-and-functions><span class=hanchor arialabel=Anchor></span>Add Aliases and Functions</h1></a><p>You can add custom aliases to your PowerShell profile as well. I have these in place since I use NeoVim as a terminal-based text editor, but reflexively use the <code>vi</code> and <code>vim</code> commands even on Windows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Set-Alias</span> <span class=n>-Name</span> <span class=s1>&#39;vi&#39;</span> <span class=n>-Value</span> <span class=s1>&#39;nvim&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>Set-Alias</span> <span class=n>-Name</span> <span class=s1>&#39;vim&#39;</span> <span class=n>-Value</span> <span class=s1>&#39;nvim&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>This means that I can use <code>vi</code> or <code>vim</code> to edit files in-terminal instead of having to remember to use <code>nvim</code> for NeoVim; this is a more comfortable experience from me since <code>vim</code> is what I use on Linux.</p><p>Additionally, you can add custom functions to your profile. Here&rsquo;s a fun one that uses the <strong>wttr.in</strong> GitHub project to get the weather (be sure to check out the project in the Additional Resources section at the end of this post):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=k>function</span> <span class=nb>Get-Weather</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nb>Invoke-RestMethod</span> <span class=n>-Method</span> <span class=n>GET</span> <span class=n>-Uri</span> <span class=s1>&#39;https://wttr.in/cupertino?format=3&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>With that addition, you can use <code>Get-Weather</code> to get your specified location&rsquo;s current weather forecast:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cupertino: ☀️   +48°F
</span></span></code></pre></td></tr></table></div></div><p>While this particular example might seem trivial, hopefully you can see just how helpful and flexible this can be!</p><p>I&rsquo;ve also added functions specific to my work environment, such as commands that let me interact with incidents, changes, and other items in our ITIL service management platform, quick scripts for checking disk space, unlocking Active Directory users, getting logs, etc. I&rsquo;ll leave those up to your imagination based on your needs in your environment.</p><a href=#adding-an-in-terminal-text-editor><h1 id=adding-an-in-terminal-text-editor><span class=hanchor arialabel=Anchor></span>Adding an in-terminal Text Editor</h1></a><p>As someone who spends a fair bit of time administering Linux servers from a command line, one thing that I can&rsquo;t live without is the ability to quickly edit files from the terminal without launching a GUI-based application. Naturally, I had to install a terminal-based text editor!</p><p>You can install
<a href=https://github.com/okibcn/nano-for-windows rel=noopener>Nano for Windows</a> or
<a href=https://www.vim.org/download.php rel=noopener>Vim</a> or other editors if you so desire.</p><p>I personally use
<a href=https://neovim.io/ rel=noopener>NeoVim</a> and have the
<a href=https://github.com/NvChad/NvChad rel=noopener>NVChad</a> configuration installed as shown in the screenshots at the beginning of this post.</p><a href=#message-of-the-day><h1 id=message-of-the-day><span class=hanchor arialabel=Anchor></span>Message of the Day</h1></a><p>Linux admins will be familiar with the MOTD concept. If we want to specify a message of the day in our profile, we can simply <code>Write-Host</code> with the message:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Welcome to your customized profile!&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>If you want to go way overboard, you can execute applications and have them output into the terminal as part of the message of the day as well.</p><p>In the screenshots at the beginning of this post, you&rsquo;ll see system information printed in the terminal. This is due to my having
<a href=https://github.com/lptstr/winfetch rel=noopener>Winfetch</a> (a Windows alternative to Neofetch on Linux systems) installed, and calling it in my profile script:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=n>winfetch</span>
</span></span></code></pre></td></tr></table></div></div><a href=#working-with-multiple-profiles><h1 id=working-with-multiple-profiles><span class=hanchor arialabel=Anchor></span>Working with Multiple Profiles</h1></a><p>You might want to use multiple PowerShell profiles for different scenarios or purposes. For example, you might have a profile for the PowerShell console and another one for VS Code. Or you might have a profile for your personal use and another one for your work use.</p><p>Earlier we talked about using <code>$profile</code> to print the path to your current profile to the terminal. When working with multiple profiles, you can use <code>$profile.CurrentUserAllHosts</code> to return the path of the profile for the current user and all hosts.</p><p>If you want to create a new profile for all users on the current host, you can do:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>New-Item</span> <span class=n>-Path</span> <span class=nv>$profile</span><span class=p>.</span><span class=n>AllUsersCurrentHost</span> <span class=n>-ItemType</span> <span class=n>File</span> <span class=n>-Force</span>
</span></span></code></pre></td></tr></table></div></div><p>To load a different profile than the current one, you can use the dot sourcing operator followed by the path to the profile file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=p>.</span> <span class=nv>$env:userprofile</span><span class=p>\</span><span class=n>Documents</span><span class=p>\</span><span class=n>other_profile</span><span class=p>.</span><span class=n>ps1</span>
</span></span></code></pre></td></tr></table></div></div><a href=#performance-considerations><h1 id=performance-considerations><span class=hanchor arialabel=Anchor></span>Performance Considerations</h1></a><p>There are a lot of cool things we can do in our profile script, <strong>but</strong> it is important to keep in mind that the more you put into your profile script, the more time it takes for your profile to load when you start your terminal emulator. You&rsquo;ll want to avoid pre-loading entire modules if you don&rsquo;t need to, and also limiting the number and length of functions in your profile. If needed, reference another script in your profile instead of including the entire script. Keep these types of things in mind as you customize your profile to ensure you don&rsquo;t spend needless seconds (or worse, minutes) waiting for your profile to load.</p><a href=#conclusion><h1 id=conclusion><span class=hanchor arialabel=Anchor></span>Conclusion</h1></a><p>In this post, we have learned how to use PowerShell profiles to customize our PowerShell environment and enhance our productivity. We have seen how to locate and edit the profile file, how to change the prompt theme using manual settings or Oh My Posh, how to add custom aliases and functions, how to install a terminal-based text editor, and how to work with multiple profiles for different scenarios or purposes. PowerShell profiles are a powerful and flexible way to tailor PowerShell to our needs and preferences. By using them wisely, we can make our PowerShell experience more enjoyable and efficient. I hope that you found some bit of this blog post helpful!</p><a href=#additional-resources><h1 id=additional-resources><span class=hanchor arialabel=Anchor></span>Additional Resources</h1></a><p>Theme Tools:</p><ul><li><a href=https://ohmyposh.dev/docs/ rel=noopener>Oh My Posh Documentation</a></li><li><a href=https://github.com/microsoft/terminal/tree/main/src/tools/ColorTool rel=noopener>ColorTool Documentation</a></li></ul><p>Terminal-based Text Editors:</p><ul><li><a href=https://neovim.io/doc/ rel=noopener>NeoVim Documentation</a></li><li><a href=https://github.com/NvChad/NvChad rel=noopener>NVChad Documentation</a></li></ul><p>Fun Tools:</p><ul><li><a href=https://github.com/chubin/wttr.in rel=noopener>Wttr.in - Check the Weather from your terminal</a></li><li><a href=https://github.com/lptstr/winfetch rel=noopener>Winfetch - Print pretty system information to your terminal</a></li></ul><p>PowerShell Profiles Documentation:</p><ul><li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.3" rel=noopener>about Profiles - PowerShell | Microsoft Learn</a></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/toc/ data-ctx="Customize your PowerShell Profile" data-src=/toc class=internal-link>Table of Contents</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://blog.griff.systems/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Barker, Griff using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2025</p><ul><li><a href=https://blog.griff.systems/>Home</a></li><li><a href=https://bsky.app/profile/griff.systems>Follow me on BlueSky</a></li><li><a href=https://griff.systems/signal>Message me on Signal</a></li></ul></footer></div></div></body></html>