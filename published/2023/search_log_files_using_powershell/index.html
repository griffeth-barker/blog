<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="You&rsquo;re troubleshooting an application and need to look through the logs to find out what is happening. We&rsquo;ve all been there, right?"><meta property="og:title" content="Search Log Files Using PowerShell"><meta property="og:description" content="You&rsquo;re troubleshooting an application and need to look through the logs to find out what is happening. We&rsquo;ve all been there, right?"><meta property="og:type" content="website"><meta property="og:image" content="https://blog.griff.systems/icon.png"><meta property="og:url" content="https://blog.griff.systems/published/2023/search_log_files_using_powershell/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="Search Log Files Using PowerShell"><meta name=twitter:description content="You&rsquo;re troubleshooting an application and need to look through the logs to find out what is happening. We&rsquo;ve all been there, right?"><meta name=twitter:image content="https://blog.griff.systems/icon.png"><title>Search Log Files Using PowerShell</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://blog.griff.systems//icon.png><link href=https://blog.griff.systems/styles.fffd770d24ddfc56e6e5100632f5b743.min.css rel=stylesheet><link href=https://blog.griff.systems/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://blog.griff.systems/js/darkmode.c869d3a61240a800a16e2c2547d7ba0e.min.js></script>
<script src=https://blog.griff.systems/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://blog.griff.systems/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://blog.griff.systems/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://blog.griff.systems/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://blog.griff.systems/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://blog.griff.systems/",fetchData=Promise.all([fetch("https://blog.griff.systems/indices/linkIndex.948e3cfde2b19484b9d6e13b95bb071d.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://blog.griff.systems/indices/contentIndex.561ae116645dc7e2682e9d8593ccab15.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://blog.griff.systems",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://blog.griff.systems",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=()=>{addCopyButtons(),addTitleToCodeBlocks()}</script><script type=module>
    import { attachSPARouting } from "https:\/\/blog.griff.systems\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=blog.griff.systems src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://blog.griff.systems/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://blog.griff.systems/>griff.systems</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Search Log Files Using PowerShell</h1><p class=meta>Last updated
Oct 23, 2023</p><ul class=tags><li><a href=https://blog.griff.systems/tags/powershell/>Powershell</a></li><li><a href=https://blog.griff.systems/tags/troubleshooting/>Troubleshooting</a></li><li><a href=https://blog.griff.systems/tags/TerminalTipTuesday/>Terminal tip tuesday</a></li><li><a href=https://blog.griff.systems/tags/logs/>Logs</a></li></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents></nav></details></aside><p>You&rsquo;re troubleshooting an application and need to look through the logs to find out what is happening. We&rsquo;ve all been there, right? Log files are an important resource during troubleshooting. So much so, that if you open a ticket with the software vendor, their support will likely open up their communication by requesting the log files.</p><p>By reading and searching log files, you can find clues and insights that can help you diagnose and fix the problem. However, reading and searching log files can also be a tedious and time-consuming task, especially if you have to deal with large, complex, or multiple log files. Thatâ€™s why using PowerShell to read and search log files can be a helpful time saver. PowerShell is a powerful scripting language that can automate and simplify many tasks related to system administration, including working with log files.</p><p>In this blog post, we&rsquo;ll talk about how to use PowerShell to read and search log files during troubleshooting.</p><p>Want to follow along? You can get the sample log file by using these commands:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=c># Create a temp directory</span>
</span></span><span class=line><span class=cl><span class=nv>$WorkingDir</span> <span class=p>=</span> <span class=s2>&#34;C:\temp&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(!(</span><span class=nb>Test-Path</span> <span class=n>-Path</span> <span class=nv>$WorkingDir</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>  <span class=nb>New-Item</span> <span class=n>-Path</span> <span class=s2>&#34;C:\&#34;</span> <span class=n>-Name</span> <span class=s2>&#34;temp&#34;</span> <span class=n>-ItemType</span> <span class=s2>&#34;directory&#34;</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=c># Set location to the temp directory</span>
</span></span><span class=line><span class=cl><span class=nb>Set-Location</span> <span class=n>-Path</span> <span class=nv>$WorkingDir</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=c># Get the sample log file</span>
</span></span><span class=line><span class=cl><span class=c># LogHub on GitHub has a great sample log file that we&#39;ll use for this. Go check out their repository at https://github.com/logpai/loghub</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=s2>&#34;https://raw.githubusercontent.com/logpai/loghub/master/Windows/Windows_2k.log&#34;</span> <span class=n>-OutFile</span> <span class=s2>&#34;$WorkingDir\sample.log&#34;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#reading-an-entire-log-file><h1 id=reading-an-entire-log-file><span class=hanchor arialabel=Anchor></span>Reading an Entire Log File</h1></a><blockquote><p>If you&rsquo;re following along, be sure your terminal&rsquo;s Present Working Directory (pwd) is <code>C:\temp</code> and that you have the <code>C:\temp\sample.log</code> file in that directory.</p></blockquote><p>The most basic task is getting the content of the log file. We can accomplish this simply:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Get-Content</span> <span class=n>sample</span><span class=p>.</span><span class=n>log</span>
</span></span></code></pre></td></tr></table></div></div><p>The above command will read the entire log file and display its contents in your terminal window; the output would look something like this (I&rsquo;ve truncated the output to just the first item for the sake of reducing the amount of scrolling in this blog post, as the output is hundreds of lines long):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2016-09-28 04:30:30, Info                  CBS    Loaded Servicing Stack v6.1.7601.23505 with Core: C:\Windows\winsxs\amd64_microsoft-windows-servicingstack_31bf3856ad364e35_6.1.7601.23505_none_681aa442f6fed7f0\cbscore.dll
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><p>Being able to read the file is one thing, but it&rsquo;s not the <em>most</em> helpful thing in the world.</p><a href=#searching-a-single-log-file><h1 id=searching-a-single-log-file><span class=hanchor arialabel=Anchor></span>Searching a Single Log File</h1></a><p>What if we have an error and want to find out more about it? We can search the log file for the error using the <code>Select-String</code> command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Select-String</span> <span class=n>-Path</span> <span class=p>.\</span><span class=n>sample</span><span class=p>.</span><span class=n>log</span> <span class=n>-Pattern</span> <span class=s2>&#34;Failed to upload all unsent reports.&#34;</span> <span class=n>-SimpleMatch</span>
</span></span></code></pre></td></tr></table></div></div><p>This first gets all the content of the log file, then selects any lines that have our search pattern in them. The <code>-SimpleMatch</code> switch allows for a basic search instead of the default search which uses regular expressions (regex).</p><blockquote><p>Note: If you want to shorten up this command, you can replace <code>Select-String</code> with its alias <code>sls</code>.</p></blockquote><p>Now the output looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2016-09-28 04:30:31, Info                  CBS    SQM: Warning: Failed to upload all unsent reports. [HRESULT =
</span></span><span class=line><span class=cl>0x80004005 - E_FAIL]
</span></span><span class=line><span class=cl>2016-09-29 00:00:46, Info                  CBS    SQM: Warning: Failed to upload all unsent reports. [HRESULT =
</span></span><span class=line><span class=cl>0x80004005 - E_FAIL]
</span></span></code></pre></td></tr></table></div></div><p>Now we&rsquo;d know that some unset reports failed to upload, have their timestamps, and the error code which likely denotes the reason that they failed to upload (though we&rsquo;d need to consult the application vendor&rsquo;s documentation to verify).</p><p>This same example could be used to look for any instances of a specific error message in the log:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Select-String</span> <span class=n>-Path</span> <span class=p>.\</span><span class=n>sample</span><span class=p>.</span><span class=n>log</span> <span class=n>-Pattern</span> <span class=n>0x80004005</span> <span class=n>-SimpleMatch</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Note: The <code>-Pattern</code> parameter can accept multiple items in an array as an input! You could search two errors by using <code>Pattern '0x800004005','0x800005007'</code> if you needed to.</p></blockquote><p>What if we wanted to look at the first error we returned for the Failure message and get some context? <code>Select-String</code> has a parameter <code>-Context</code> that lets us return X number of lines before the matched pattern, and Y number of lines after the matched pattern. Let&rsquo;s get that first instance of the error and also get the 3 lines before the error to see if something else relevant to the issue happened:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Select-String</span> <span class=n>-Path</span> <span class=p>.\</span><span class=n>sample</span><span class=p>.</span><span class=n>log</span> <span class=n>-Pattern</span> <span class=s2>&#34;Failed to upload all unsent reports.&#34;</span> <span class=n>-SimpleMatch</span> <span class=n>-Context</span> <span class=n>3</span><span class=p>,</span><span class=n>0</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-First</span> <span class=n>1</span>
</span></span></code></pre></td></tr></table></div></div><p>In the above example, <code>Get-Content sample.log</code> is reading the entire log file, and then we pipe that output into <code>Select-String -Pattern "Failed to upload all unsent reports." -SimpleMatch -Context 3,0</code> where we search for the error using <code>-Pattern</code> and <code>-SimpleMatch</code>, and also ask for the 3 lines before the error with <code>-Context 3,0</code>.</p><p>The output looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  2016-09-28 04:30:31, Info                  CBS    SQM: Failed to start upload with file pattern:
</span></span><span class=line><span class=cl>C:\Windows\servicing\sqm\*_std.sqm, flags: 0x2 [HRESULT = 0x80004005 - E_FAIL]
</span></span><span class=line><span class=cl>  2016-09-28 04:30:31, Info                  CBS    SQM: Failed to start standard sample upload. [HRESULT = 0x80004005
</span></span><span class=line><span class=cl>- E_FAIL]
</span></span><span class=line><span class=cl>  2016-09-28 04:30:31, Info                  CBS    SQM: Queued 0 file(s) for upload with pattern:
</span></span><span class=line><span class=cl>C:\Windows\servicing\sqm\*_all.sqm, flags: 0x6
</span></span><span class=line><span class=cl>&gt; 2016-09-28 04:30:31, Info                  CBS    SQM: Warning: Failed to upload all unsent reports. [HRESULT =
</span></span><span class=line><span class=cl>0x80004005 - E_FAIL]
</span></span></code></pre></td></tr></table></div></div><p>If this were a real-world situation, those preceding lines could tell us why the error occurred.</p><a href=#searching-multiple-log-files><h1 id=searching-multiple-log-files><span class=hanchor arialabel=Anchor></span>Searching Multiple Log Files</h1></a><p>Alright, that&rsquo;s not so bad for a single log file. But what if the application has multiple log files?
No problem! This gets a little more involved, but still easily doable. I&rsquo;ll provide an example here, but there&rsquo;s no follow-along since we only downloaded one log file for the sample.</p><p>By inserting a <code>*</code> into the path of the log file(s), we can account for any files in the folder which have the file extension <code>.log</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Select-String</span> <span class=n>-Path</span> <span class=s2>&#34;C:\temp\*.log&#34;</span> <span class=n>-Pattern</span> <span class=s1>&#39;Failed&#39;</span> <span class=n>-List</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-Property</span> <span class=n>Filename</span><span class=p>,</span><span class=n>LineNumber</span><span class=p>,</span><span class=n>Line</span> <span class=p>|</span> <span class=nb>Format-Table</span> <span class=n>-AutoSize</span>
</span></span></code></pre></td></tr></table></div></div><p>The output looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Filename    LineNumber Line
</span></span><span class=line><span class=cl>--------    ---------- ----
</span></span><span class=line><span class=cl>sample.log          11 2016-09-28 04:30:31, Info                  CBS    SQM: Failed to start upload with file patte...
</span></span><span class=line><span class=cl>sample2.log          1 0000-00-00 00:00:00,  ERROR  The task failed successfully ;-)
</span></span></code></pre></td></tr></table></div></div><blockquote><p>If you wanted, you could even output this into the PowerShell GridView, which will open the results in a GUI window that allows you to sort by columns and filter further. Use the same command but replace <code>Format-Table -AutoSize</code> with <code>Out-GridView</code> in that case.</p></blockquote><p>With the above command, you now have results of your search from <strong>two</strong> log files in a single view, rather than opening both files and manually searching files.</p><a href=#filtering-by-date><h1 id=filtering-by-date><span class=hanchor arialabel=Anchor></span>Filtering by Date</h1></a><p>When troubleshooting, it&rsquo;s often helpful to narrow the scope of time involved. When you&rsquo;re dealing with systems that use verbose logging, there can be a lot of content to search through. The method of filtering by date can vary from situation to situation based on how the application logs its actions, but for this specific example, we&rsquo;ll essentially read the lines of the log and search for a partial datetime:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Select-String</span> <span class=n>-Path</span> <span class=s2>&#34;C:\temp\*.log&#34;</span> <span class=n>-Pattern</span> <span class=s1>&#39;2016-09-28 04:&#39;</span> <span class=n>-List</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-Property</span> <span class=n>Filename</span><span class=p>,</span><span class=n>LineNumber</span><span class=p>,</span><span class=n>Line</span> <span class=p>|</span> <span class=nb>Format-Table</span> <span class=n>-AutoSize</span>
</span></span></code></pre></td></tr></table></div></div><p>The above command will return any entries in any log files in <code>C:\temp</code> which contain occurred on September 28th, 2016 between 4:00 AM and 4:59 AM. This is an example of significantly narrowing the scope of the logs you are reviewing, and the output looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Filename   LineNumber Line
</span></span><span class=line><span class=cl>--------   ---------- ----
</span></span><span class=line><span class=cl>sample.log          1 2016-09-28 04:30:30, Info                  CBS    Loaded Servicing Stack v6.1.7601.23505 with ...
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Again, you could instead pipe the result into <code>Out-GridView</code> instead of <code>Format-Table</code> if you so choose.</p></blockquote><a href=#find-recently-written-log-files><h1 id=find-recently-written-log-files><span class=hanchor arialabel=Anchor></span>Find Recently Written Log Files</h1></a><p>Many applications will truncate their log files to prevent a single log file from growing too large. You&rsquo;ve probably seen a log file directory before that has multiple files in it like:</p><ul><li>events01.log</li><li>events02.log</li><li>events03.log</li><li>etc&mldr;</li></ul><p>If you want to be sure you only look at log files that have been <strong>recently written to</strong>, then this is how to find those:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Powershell data-lang=Powershell><span class=line><span class=cl><span class=nb>Get-ChildItem</span> <span class=n>-Path</span> <span class=s1>&#39;C:\temp&#39;</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=n>Name</span> <span class=o>-like</span> <span class=s2>&#34;*.log*&#34;</span> <span class=o>-and</span> <span class=nv>$_</span><span class=p>.</span><span class=n>LastWriteTime</span> <span class=o>-gt</span> <span class=p>(</span><span class=nb>Get-Date</span><span class=p>).</span><span class=n>AddHours</span><span class=p>(-</span><span class=n>1</span><span class=p>)}</span>
</span></span></code></pre></td></tr></table></div></div><p>This will return you a list of files with the <code>.log</code> file extension in the <code>C:\temp</code> directory whose <code>LastWriteTime</code> property is one hour ago or newer. You can modify as needed to narrow down the time period you want.</p><a href=#watch-a-log-file><h1 id=watch-a-log-file><span class=hanchor arialabel=Anchor></span>Watch a Log File</h1></a><p>Alright so you know the log file that you need to look at, but of course nobody can tell you the last time the issue occurred. Like we often do in IT work, we can have the person experiencing the issue reproduce the issue. We&rsquo;ll want to be watching the log file <em>while</em>
this happens to be sure we see the issue get logged. There&rsquo;s an easy way to do this with PowerShell!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Get-Content</span> <span class=n>-Path</span> <span class=s1>&#39;C:\temp\sample.log&#39;</span> <span class=n>-Tail</span> <span class=n>5</span> <span class=n>-Wait</span>
</span></span></code></pre></td></tr></table></div></div><p>Here we are getting the last 5 lines of the log file, and waiting for new entries to appear. As they appear, they&rsquo;ll be displayed in the terminal.</p><blockquote><p>Note: If you want to shorten this command a bit, you can replace <code>Get-Content</code> with its alias: <code>type</code>.</p></blockquote><a href=#conclusion><h1 id=conclusion><span class=hanchor arialabel=Anchor></span>Conclusion</h1></a><p>In this post we looked at how to use PowerShell to read and search log files for troubleshooting purposes. We have seen how to read an entire log file using theÂ <code>Get-Content</code>Â cmdlet, how to search a single log file using theÂ <code>Select-String</code>Â cmdlet, and how to search multiple log files at once using theÂ <code>Get-ChildItem</code>Â andÂ <code>Where-Object</code>Â cmdlets. We have also learned how to filter log files by date using theÂ <code>LastWriteTime</code>Â property.</p><p>By using PowerShell to work with log files, we can save time and effort, as well as perform more advanced and flexible searches. PowerShell is a powerful scripting language that can help us with many tasks related to system administration, including log file analysis and troubleshooting.</p><p>I hope you enjoyed this blog post and found some bit of helpful information in it. The next time you need to review a log file (especially if its on a Windows Core server), do consider using these techniques to find the information you&rsquo;re looking for!</p><a href=#additional-resources><h1 id=additional-resources><span class=hanchor arialabel=Anchor></span>Additional Resources</h1></a><ul><li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-content?view=powershell-7.3" rel=noopener>Get-Content (Microsoft.PowerShell.Management) - PowerShell | Microsoft Learn</a></li><li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/select-string?view=powershell-7.3" rel=noopener>Select-String (Microsoft.PowerShell.Utility) - PowerShell | Microsoft Learn</a></li><li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-childitem?view=powershell-7.3" rel=noopener>Get-ChildItem (Microsoft.PowerShell.Management) - PowerShell | Microsoft Learn</a></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/drafts/toc_by_year/ data-ctx="Search Log Files Using PowerShell" data-src=/drafts/toc_by_year class=internal-link>Table of Contents</a></li><li><a href=/toc/ data-ctx="Search Log Files Using PowerShell" data-src=/toc class=internal-link>Table of Contents</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://blog.griff.systems/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Griff Barker using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2025</p><ul><li><a href=https://blog.griff.systems/>Home</a></li><li><a href=https://griff.systems/bluesky>Follow me on BlueSky</a></li><li><a href=https://griff.systems/linkedin>Connect with me on LinkedIn</a></li><li><a href=https://griff.systems/github>Follow me on GitHub</a></li><li><a href=https://griff.systems/signal>Message me on Signal</a></li></ul></footer></div></div></body></html>