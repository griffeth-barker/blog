<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Import PowerShell Modules Directly from GitHub or GitLab without Installing We know and love PowerShell modules. They do a lot of heavy lifting in the automation world!"><meta property="og:title" content><meta property="og:description" content="Import PowerShell Modules Directly from GitHub or GitLab without Installing We know and love PowerShell modules. They do a lot of heavy lifting in the automation world!"><meta property="og:type" content="website"><meta property="og:image" content="https://blog.griff.systems/icon.png"><meta property="og:url" content="https://blog.griff.systems/published/2025/import-powershell-modules-directly-from-web/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Import PowerShell Modules Directly from GitHub or GitLab without Installing We know and love PowerShell modules. They do a lot of heavy lifting in the automation world!"><meta name=twitter:image content="https://blog.griff.systems/icon.png"><title>griff.systems</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://blog.griff.systems//icon.png><link href=https://blog.griff.systems/styles.fffd770d24ddfc56e6e5100632f5b743.min.css rel=stylesheet><link href=https://blog.griff.systems/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://blog.griff.systems/js/darkmode.c869d3a61240a800a16e2c2547d7ba0e.min.js></script>
<script src=https://blog.griff.systems/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://blog.griff.systems/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://blog.griff.systems/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://blog.griff.systems/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://blog.griff.systems/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://blog.griff.systems/",fetchData=Promise.all([fetch("https://blog.griff.systems/indices/linkIndex.5c5c5666bf3e94603f48d94159499aa7.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://blog.griff.systems/indices/contentIndex.8c311aca8120dae3d9fe193f2152901c.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://blog.griff.systems",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://blog.griff.systems",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=()=>{addCopyButtons(),addTitleToCodeBlocks()}</script><script type=module>
    import { attachSPARouting } from "https:\/\/blog.griff.systems\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=blog.griff.systems src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://blog.griff.systems/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://blog.griff.systems/>griff.systems</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Jun 3, 2025</p><ul class=tags></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#methodology>Methodology</a><ol><li><a href=#parameters>Parameters</a></li><li><a href=#uris>URIs</a></li><li><a href=#github-or-gitlab>GitHub or GitLab?</a></li><li><a href=#downloading-the-repository>Downloading the Repository</a></li><li><a href=#importing-the-module>Importing the Module</a></li></ol></li><li><a href=#considerations-and-future-improvements>Considerations and Future Improvements</a></li><li><a href=#wrapping-up>Wrapping Up</a></li></ol></nav></details></aside><a href=#import-powershell-modules-directly-from-github-or-gitlab-without-installing><h1 id=import-powershell-modules-directly-from-github-or-gitlab-without-installing><span class=hanchor arialabel=Anchor></span>Import PowerShell Modules Directly from GitHub or GitLab without Installing</h1></a><p>We know and love PowerShell modules. They do a lot of heavy lifting in the automation world! However, you might find yourself in a situation where you are not able to install a module on a system, but still want to make use of its functionality. For this purpose, I have <code>Import-ModuleFromGitx</code>.</p><p>This is a function that takes in the URL of a public, cloud-hosted, GitHub or GitLab repository and imports it directly into your current PowerShell session.</p><a href=#methodology><h2 id=methodology><span class=hanchor arialabel=Anchor></span>Methodology</h2></a><a href=#parameters><h3 id=parameters><span class=hanchor arialabel=Anchor></span>Parameters</h3></a><p>There are two parameters for the function.</p><p><code>-Uri</code> is the URL of the repository you want to import. This required string can be piped in if you like, or specified directly.</p><p><code>-OutputDir</code> is the target directory to which the module will be downloaded. This string is optional, and will default to the present working directory if not specified.</p><a href=#uris><h3 id=uris><span class=hanchor arialabel=Anchor></span>URIs</h3></a><p>The first problem I had is that the commonly used link for repositories is not a link that can be used to download the repository directly. To resolve this, I use a private helper function to parse the provided URI and construct the appropriate format that will let us download the repository. You know what they say: &ldquo;if you have a problem and regex is the answer, you now have two problems.&rdquo; I&rsquo;m admittedly not the best at regex, but luckily
<a href=https://regex101.com/ rel=noopener>regex101.com</a> exists and I ended up with this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=k>function</span> <span class=n>constructGitHubUri</span><span class=p>(</span><span class=nv>$Url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c># Desired format: https://github.com/username/repositoryname/archive/refs/heads/main.zip</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nv>$Uri</span> <span class=o>-match</span> <span class=s2>&#34;^https://github\.com/([^/]+)/([^/]+)(?:/)?$&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$user</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nv>$repo</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>2</span><span class=p>]</span> <span class=o>-replace</span> <span class=s2>&#34;\.git$&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;https://github.com/$user/$repo/archive/refs/heads/main.zip&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#github-or-gitlab><h3 id=github-or-gitlab><span class=hanchor arialabel=Anchor></span>GitHub or GitLab?</h3></a><p>I originally wrote this function specifically for GitHub, but realized it could be handy to make it support GitLab as well. Unfortunately, the URI format for GitHub and GitLab are different, so I have a similar private helper function for this one, too:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=k>function</span> <span class=n>constructGitLabUri</span><span class=p>(</span><span class=nv>$Url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c># Desired format: https://gitlab.com/workspacename/projectname/-/archive/main/projectname.zip</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nv>$Uri</span> <span class=o>-match</span> <span class=s2>&#34;^https://gitlab\.com/([^/]+)/([^/]+)(?:/)?$&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$workspace</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nv>$repo</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>2</span><span class=p>]</span> <span class=o>-replace</span> <span class=s2>&#34;\.git$&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;https://gitlab.com/$workspace/$repo/-/archive/main/$repo-main.zip&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>To determine which helper function to use, I use a <code>switch</code> statement:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=k>switch</span> <span class=p>(</span><span class=nv>$Uri</span><span class=p>.</span><span class=n>Split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)[</span><span class=n>2</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;github.com&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$downloadUrl</span> <span class=p>=</span> <span class=n>constructGitHubUri</span> <span class=n>-url</span> <span class=nv>$Uri</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;gitlab.com&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$downloadUrl</span> <span class=p>=</span> <span class=n>constructGitLabUri</span> <span class=n>-url</span> <span class=nv>$Uri</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>exit</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#downloading-the-repository><h3 id=downloading-the-repository><span class=hanchor arialabel=Anchor></span>Downloading the Repository</h3></a><p>I then make a temporary directory to store the downloaded repository, verify that the target output directory exists, download the repository as a .zip archive, and extract it to the output directory.</p><p>The name of the staged .zip archive has a random GUID included to avoid any name collisions in the event that the same filename is already present. Additonally, the script checks to validate that the output directory exists and creates it if it does not.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl>  <span class=nv>$tempZipPath</span> <span class=p>=</span> <span class=s2>&#34;$env:TEMP\repo_</span><span class=p>$(</span><span class=nb>New-Guid</span><span class=p>)</span><span class=s2>.zip&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=p>(</span><span class=nb>Test-Path</span> <span class=nv>$OutputDir</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>New-Item</span> <span class=n>-ItemType</span> <span class=n>Directory</span> <span class=n>-Path</span> <span class=nv>$OutputDir</span> <span class=p>|</span> <span class=nb>Out-Null</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=nv>$downloadUrl</span> <span class=n>-OutFile</span> <span class=nv>$tempZipPath</span> <span class=n>-ErrorAction</span> <span class=n>Stop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Expand-Archive</span> <span class=n>-Path</span> <span class=nv>$tempZipPath</span> <span class=n>-DestinationPath</span> <span class=nv>$OutputDir</span> <span class=n>-Force</span> <span class=n>-ErrorAction</span> <span class=n>Stop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Remove-Item</span> <span class=nv>$tempZipPath</span> <span class=n>-Force</span>
</span></span></code></pre></td></tr></table></div></div><p>The download and extraction is accomplished using simple, Windows-native functionality, such as <code>Invoke-WebRequest</code> for downloading the .zip archive and <code>Expand-Archive</code> for extracting it to the output directory. It was important to me that this function have no external dependencies (like needing Git installed on the machine).</p><a href=#importing-the-module><h3 id=importing-the-module><span class=hanchor arialabel=Anchor></span>Importing the Module</h3></a><p>At this point, it&rsquo;s import time! As you&rsquo;d expect, I&rsquo;m just using <code>Import-Module</code> as usual, but targeting the <code>.psm1</code> file in the downloaded and extracted repository:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Import-Module</span> <span class=n>-Name</span> <span class=p>(</span><span class=nb>Get-ChildItem</span> <span class=n>-Path</span> <span class=nv>$OutputDir</span> <span class=n>-Recurse</span> <span class=n>-Filter</span> <span class=p>*.</span><span class=n>psm1</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-First</span> <span class=n>1</span><span class=p>).</span><span class=n>FullName</span>
</span></span></code></pre></td></tr></table></div></div><p>Using <code>Get-ChildItem</code> with the <code>-Recurse</code> and <code>-Filter</code> parameters helps in easily finding the PowerShell module file that contains the functions to import. Because of this, the function does not yet support repositories with more complex structures or multiple modules. It grabs the first <code>.psm1</code> file it finds&ndash;assuming that there is only one&ndash;which works for simple modules but might not work as expected if you in a nested or poly-module setup.</p><p>Of course, I also added some debug/verbose output and some light error handling as well but I figured I wouldn&rsquo;t make this post longer than needed with that.</p><a href=#considerations-and-future-improvements><h2 id=considerations-and-future-improvements><span class=hanchor arialabel=Anchor></span>Considerations and Future Improvements</h2></a><p>There are a few important caveats to know.</p><p>First, this function assumes that the main branch is named <code>main</code>, which is the current Git default but not guaranteed. If the repository uses <code>master</code> or a custom branch name, this will not work; I intend to add a <code>-Branch</code> parameter to resolve this in the near future.</p><p><strong>Security Note</strong><br>Another thing to keep in mind is that the function doesn’t verify anything about the contents of the repo. There’s no signing check, no validation—so this is strictly a trust-based approach. You’ll want to be cautious and know what you&rsquo;re pulling in.</p><p><strong>Compliance Note</strong><br>It is possible to use this function to get around restrictions in your environment that prevent you from installing modules directly from the PowerShell Gallery or other sources. You should comply with all regulations, company policies, licensing agreements, and other requirements/restrictions. Use responsibly and at your own risk.</p><a href=#wrapping-up><h2 id=wrapping-up><span class=hanchor arialabel=Anchor></span>Wrapping Up</h2></a><p>Mostly, this was just a fun little exercise in PowerShell for me. But it could potentially be useful at some point, so I&rsquo;m sharing it. If you find yourself in a similar situation, I hope this helps.</p><p>The full function is available as a
<a href=https://gist.github.com/griffeth-barker/30d781904c9a9579ce360303c4ed9e93 rel=noopener>GitHub Gist</a> as well as shown below:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=k>function</span> <span class=nb>Import-ModuleFromGitx</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>&lt;#
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.SYNOPSIS</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        Imports a PowerShell module from a GitHub repository.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.DESCRIPTION</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        This function lets you import a PowerShell module directly from a GitHub repository without needing to install the module.
</span></span></span><span class=line><span class=cl><span class=cm>        The module is downloaded from the specified GitHub repository URI, extracted, and imported into your current PowerShell session.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.PARAMETER</span><span class=cm> Uri
</span></span></span><span class=line><span class=cl><span class=cm>        The URI of the GitHub repository. This can be obtained by clicking the green &#34;Code&#34; button on the repository page and copying the HTTPS URL.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        Type                : String
</span></span></span><span class=line><span class=cl><span class=cm>        Required            : True
</span></span></span><span class=line><span class=cl><span class=cm>        ValueFromPipeline   : True
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.PARAMETER</span><span class=cm> OutputDir
</span></span></span><span class=line><span class=cl><span class=cm>        The directory where the module will be downloaded and imported.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        Type                : String
</span></span></span><span class=line><span class=cl><span class=cm>        Required            : False
</span></span></span><span class=line><span class=cl><span class=cm>        Default Value       : $pwd
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.EXAMPLE</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        # Import a PowerShell module from a GitHub or GitLab repository
</span></span></span><span class=line><span class=cl><span class=cm>        Import-ModuleFromGitx -Uri &#34;https://github.com/username/repository.git&#34;
</span></span></span><span class=line><span class=cl><span class=cm>        Import-ModuleFromGitx -Uri &#34;https://gitlab.com/workspace/repository.git&#34;
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.EXAMPLE</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        # Import a PowerShell module from a GitHub or GitLab repository and specify an output directory other than the present working directory
</span></span></span><span class=line><span class=cl><span class=cm>        Import-ModuleFromGitx -Uri &#34;https://github.com/username/repository.git&#34; -OutputDir &#34;$env:USERPROFILE\Downloads&#34;
</span></span></span><span class=line><span class=cl><span class=cm>        Import-ModuleFromGitx -Uri &#34;https://gitlab.com/workspace/repository.git&#34; -OutputDir &#34;$env:USERPROFILE\Downloads&#34;
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.NOTES</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        It is possible to use this function to get around restrictions in your environment that prevent you from installing modules directly from the PowerShell Gallery or other sources.
</span></span></span><span class=line><span class=cl><span class=cm>        You should comply with all regulations, company policies, licensing agreements, and other requirements/restrictions. Use at your own risk.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        Does NOT support privately hosted versions of GitLab.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    </span><span class=sd>.LINK</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>        https://gist.github.com/griffeth-barker/30d781904c9a9579ce360303c4ed9e93
</span></span></span><span class=line><span class=cl><span class=cm>    #&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=k>CmdletBinding</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=k>Parameter</span><span class=p>(</span><span class=k>Mandatory</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>,</span> <span class=k>ValueFromPipeline</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=no>[string]</span><span class=nv>$Uri</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=k>Parameter</span><span class=p>(</span><span class=k>Mandatory</span> <span class=p>=</span> <span class=nv>$false</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=no>[string]</span><span class=nv>$OutputDir</span> <span class=p>=</span> <span class=s2>&#34;$pwd&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>begin</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>function</span> <span class=n>constructGitHubUri</span><span class=p>(</span><span class=nv>$Url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nv>$Uri</span> <span class=o>-match</span> <span class=s2>&#34;^https://github\.com/([^/]+)/([^/]+)(?:/)?$&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$user</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=nv>$repo</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>2</span><span class=p>]</span> <span class=o>-replace</span> <span class=s2>&#34;\.git$&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=s2>&#34;https://github.com/$user/$repo/archive/refs/heads/main.zip&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nb>Write-Error</span> <span class=s2>&#34;Invalid GitHub repository URL format. Should be &#39;https://github.com/username/repository.git&#39; where username and repository are the GitHub valid user and repository names.&#34;</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>function</span> <span class=n>constructGitLabUri</span><span class=p>(</span><span class=nv>$Url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nv>$Uri</span> <span class=o>-match</span> <span class=s2>&#34;^https://gitlab\.com/([^/]+)/([^/]+)(?:/)?$&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>$workspace</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=nv>$repo</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=n>2</span><span class=p>]</span> <span class=o>-replace</span> <span class=s2>&#34;\.git$&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=s2>&#34;https://gitlab.com/$workspace/$repo/-/archive/main/$repo-main.zip&#34;</span>
</span></span><span class=line><span class=cl>                <span class=c>#https://gitlab.com/griffeth-barker/testing/-/archive/main/testing-main.zip</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nb>Write-Error</span> <span class=s2>&#34;Invalid GitLab repository URL format. Should be &#39;https://gitlab.com/workspace/repository.git&#39; where username and repository are the GitLab valid user and repository names.&#34;</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>process</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=p>(</span><span class=nv>$Uri</span><span class=p>.</span><span class=n>Split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)[</span><span class=n>2</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;github.com&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nb>Write-Debug</span> <span class=s2>&#34;Detected GitHub repository; using constructGitHubUri function&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nv>$downloadUrl</span> <span class=p>=</span> <span class=n>constructGitHubUri</span> <span class=n>-url</span> <span class=nv>$Uri</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;gitlab.com&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nb>Write-Debug</span> <span class=s2>&#34;Detected GitLab repository; using constructGitLabUri function&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nv>$downloadUrl</span> <span class=p>=</span> <span class=n>constructGitLabUri</span> <span class=n>-url</span> <span class=nv>$Uri</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nb>Write-Error</span> <span class=s2>&#34;Unsupported repository type. Only GitHub and GitLab repositories are supported at this time.&#34;</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Verbose</span> <span class=s2>&#34;Creating temporary directory for download...&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Debug</span> <span class=s2>&#34;Creating &#39;$env:TEMP\repo_</span><span class=p>$(</span><span class=nb>New-Guid</span><span class=p>)</span><span class=s2>.zip&#39;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nv>$tempZipPath</span> <span class=p>=</span> <span class=s2>&#34;$env:TEMP\repo_</span><span class=p>$(</span><span class=nb>New-Guid</span><span class=p>)</span><span class=s2>.zip&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=p>(</span><span class=nb>Test-Path</span> <span class=nv>$OutputDir</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nb>New-Item</span> <span class=n>-ItemType</span> <span class=n>Directory</span> <span class=n>-Path</span> <span class=nv>$OutputDir</span> <span class=p>|</span> <span class=nb>Out-Null</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Verbose</span> <span class=s2>&#34;Downloading repository...&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Debug</span> <span class=s2>&#34;Using URI: $Uri&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=nv>$downloadUrl</span> <span class=n>-OutFile</span> <span class=nv>$tempZipPath</span> <span class=n>-ErrorAction</span> <span class=n>Stop</span>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Debug</span> <span class=s2>&#34;File saved to $tempZipPath&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Debug</span> <span class=s2>&#34;Extracting to $OutputDir&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nb>Expand-Archive</span> <span class=n>-Path</span> <span class=nv>$tempZipPath</span> <span class=n>-DestinationPath</span> <span class=nv>$OutputDir</span> <span class=n>-Force</span> <span class=n>-ErrorAction</span> <span class=n>Stop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Debug</span> <span class=s2>&#34;Removing $tempZipPath&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nb>Remove-Item</span> <span class=nv>$tempZipPath</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Verbose</span> <span class=s2>&#34;Importing module...&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Debug</span> <span class=s2>&#34;Importing module from $OutputDir&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nb>Import-Module</span> <span class=n>-Name</span> <span class=p>(</span><span class=nb>Get-ChildItem</span> <span class=n>-Path</span> <span class=nv>$OutputDir</span> <span class=n>-Recurse</span> <span class=n>-Filter</span> <span class=p>*.</span><span class=n>psm1</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-First</span> <span class=n>1</span><span class=p>).</span><span class=n>FullName</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>catch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nb>Write-Error</span> <span class=nv>$_</span><span class=p>.</span><span class=n>Exception</span><span class=p>.</span><span class=n>Message</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>end</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/toc/ data-ctx="Import PowerShell Modules Directly from GitHub or GitLab without Installing" data-src=/toc class=internal-link>Table of Contents</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://blog.griff.systems/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Griff Barker using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2025</p><ul><li><a href=https://blog.griff.systems/>Home</a></li><li><a href=https://griff.systems/bluesky>Follow me on BlueSky</a></li><li><a href=https://griff.systems/linkedin>Connect with me on LinkedIn</a></li><li><a href=https://griff.systems/github>Follow me on GitHub</a></li><li><a href=https://griff.systems/signal>Message me on Signal</a></li></ul></footer></div></div></body></html>