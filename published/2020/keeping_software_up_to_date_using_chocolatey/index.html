<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Introduction Don&rsquo;t you love those pop-ups you get in the corner of your desktop telling you there&rsquo;s an update for a program installed on your computer?"><meta property="og:title" content="Keeping software up to date using Chocolatey"><meta property="og:description" content="Introduction Don&rsquo;t you love those pop-ups you get in the corner of your desktop telling you there&rsquo;s an update for a program installed on your computer?"><meta property="og:type" content="website"><meta property="og:image" content="https://blog.griff.systems/icon.png"><meta property="og:url" content="https://blog.griff.systems/published/2020/keeping_software_up_to_date_using_chocolatey/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="Keeping software up to date using Chocolatey"><meta name=twitter:description content="Introduction Don&rsquo;t you love those pop-ups you get in the corner of your desktop telling you there&rsquo;s an update for a program installed on your computer?"><meta name=twitter:image content="https://blog.griff.systems/icon.png"><title>Keeping software up to date using Chocolatey</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://blog.griff.systems//icon.png><link href=https://blog.griff.systems/styles.80333fa2099c0bee674efa435fde378c.min.css rel=stylesheet><link href=https://blog.griff.systems/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://blog.griff.systems/js/darkmode.c869d3a61240a800a16e2c2547d7ba0e.min.js></script>
<script src=https://blog.griff.systems/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://blog.griff.systems/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://blog.griff.systems/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://blog.griff.systems/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://blog.griff.systems/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://blog.griff.systems/",fetchData=Promise.all([fetch("https://blog.griff.systems/indices/linkIndex.81ade7cb8cbf264f5fa033704aa457f3.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://blog.griff.systems/indices/contentIndex.b39c610d4d3dfaa3939e4e5ebfa31fca.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://blog.griff.systems",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://blog.griff.systems",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=()=>{addCopyButtons(),addTitleToCodeBlocks()}</script><script type=module>
    import { attachSPARouting } from "https:\/\/blog.griff.systems\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=blog.griff.systems src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://blog.griff.systems/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://blog.griff.systems/>blog.griff.systems</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Keeping software up to date using Chocolatey</h1><p class=meta>Last updated
Jun 20, 2023</p><ul class=tags><li><a href=https://blog.griff.systems/tags/windows/>Windows</a></li><li><a href=https://blog.griff.systems/tags/software/>Software</a></li><li><a href=https://blog.griff.systems/tags/patching/>Patching</a></li><li><a href=https://blog.griff.systems/tags/chocolatey/>Chocolatey</a></li></ul><a href=#introduction><h1 id=introduction><span class=hanchor arialabel=Anchor></span>Introduction</h1></a><p>Don&rsquo;t you love those pop-ups you get in the corner of your desktop telling you there&rsquo;s an update for a program installed on your computer? Or how about when you open a program and it tells you there&rsquo;s an update? You just want to use your software, so if you&rsquo;re like me, you&rsquo;ve probably clicked &ldquo;ignore&rdquo; or closed the update to just get to what you were doing. But there is a better way! Nobody wants to take the time to keep all of their software up-to-date. In this brief blog post, I take a look at how you can make this happen &ldquo;auto-magically,&rdquo; at least for many common programs.</p><a href=#installing-chocolatey-package-manager><h1 id=installing-chocolatey-package-manager><span class=hanchor arialabel=Anchor></span>Installing Chocolatey package manager</h1></a><p><img src="https://audiomgtmoregame.files.wordpress.com/2020/12/chocolatey-logo.png?w=1024" width=auto alt></p><p>The first thing we will need to do is install the Chocolatey package manager. This is going to let us have access to one central source for the programs and their updates.</p><p>To install Chocolatey, open Windows PowerShell by going to the Start Menu and typing <code>powershell</code> . Right-click the top result, and click &ldquo;Run as Administrator.&rdquo; This will require you to have administrative rights. If you do not have administrative rights, this process will not be possible.</p><p>In the Windows PowerShell window that appears, paste the following command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=nb>Set-ExecutionPolicy</span> <span class=n>Bypass</span> <span class=n>-Scope</span> <span class=k>Process</span> <span class=n>-Force</span><span class=p>;</span> <span class=no>[System.Net.ServicePointManager]</span><span class=p>::</span><span class=n>SecurityProtocol</span> <span class=p>=</span> <span class=no>[System.Net.ServicePointManager]</span><span class=p>::</span><span class=n>SecurityProtocol</span> <span class=o>-bor</span> <span class=n>3072</span><span class=p>;</span> <span class=nb>iex </span><span class=p>((</span><span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>WebClient</span><span class=p>).</span><span class=n>DownloadString</span><span class=p>(</span><span class=s1>&#39;https://chocolatey.org/install.ps1&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>Once that command has completed, close Windows PowerShell and launch it again with administrative rights like we just did.</p><a href=#installing-packages><h1 id=installing-packages><span class=hanchor arialabel=Anchor></span>Installing packages</h1></a><p>Now we need to install the packages that we want to keep up-to-date. To find out if a program you have has a package available, use the below example in PowerShell:</p><p>choco search <em>programname</em></p><p>where <em>programname</em> is the name of the program you want. Some examples might be:</p><ul><li>adobereader</li><li>adobe-connect</li><li>googlechrome</li><li>microsoft-edge</li><li>discord</li><li>putty</li><li>icue</li><li>bitwarden</li><li>lastpass</li><li>obs-studio</li><li>conemu</li><li>forticlientvpn</li><li>openvpn</li><li>java</li><li>jre</li><li>logitech-options</li><li>reflect-free</li><li>and many, many more.</li></ul><p>To actually install any or a combination of these, use the following command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=n>choco</span> <span class=n>install</span> <span class=n>programname</span> <span class=n>-y</span>
</span></span></code></pre></td></tr></table></div></div><p>where <code>programname</code> is the package name. You can list multiple package names in succession to install multiple programs at once:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=n>choco</span> <span class=n>install</span> <span class=n>programname1</span> <span class=n>programname2</span> <span class=n>programname3</span> <span class=n>-y</span>
</span></span></code></pre></td></tr></table></div></div><p>Chocolatey will download the packages and install them.</p><a href=#writing-the-update-script><h1 id=writing-the-update-script><span class=hanchor arialabel=Anchor></span>Writing the update script</h1></a><p>With the packages installed, now we need to create a super simple script that will update those packages.</p><p>Open Notepad by going to the Start Menu and typing &ldquo;notepad&rdquo; (quotations omitted) and running the top result.</p><p>In the blank document that opens, type the following:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=n>choco</span> <span class=n>upgrade</span> <span class=n>all</span> <span class=n>-Y</span>
</span></span></code></pre></td></tr></table></div></div><p>If you continually run into errors with certain packages updating and don&rsquo;t mind the insecurity of it, you can also use:</p><p>choco upgrade all -Y &ndash;ignore-checksums</p><blockquote class=warning-callout><p>Warning
This is not necessarily a security best practice. You should proceed with caution and as appropriate to your environment.</p></blockquote><p>Now save this by going to File > Save As&mldr; In the Save As window, change the drop-down menu for the file type. It will be defaulted to .txt and we want to change it to All Files. Type a name for the file ending with .ps1. Example:</p><p>chocolatey-updater.ps1</p><p>Save it to a location where it won&rsquo;t be touched and will always be available. I have mine saved to a folder I created at C:\ScheduledTasks but you can put yours wherever you want.</p><a href=#scheduling-automatic-updates><h2 id=scheduling-automatic-updates><span class=hanchor arialabel=Anchor></span>Scheduling automatic updates</h2></a><p>Finally, now that we have installed packages and created a script to update them, we will want to schedule the update process to be completely automatic. Because being hands-off is the whole point!</p><p>Open the Task Scheduler by clicking the Start Menu and typing &ldquo;task scheduler&rdquo; then running the top result.</p><p>In the resulting Task Scheduler window, open the Action menu, then click Create Task.</p><p><img src="https://audiomgtmoregame.files.wordpress.com/2020/12/screenshot-2020-12-15-135956.jpg?w=532" width=auto alt></p><p>Give your scheduled task a name and a description, then select &ldquo;Run whether user is logged in or not&rdquo; and check &ldquo;Run with highest privileges.&rdquo; Finally, Configure for: Windows 10.</p><p>Move to the Triggers tab.</p><p><img src="https://audiomgtmoregame.files.wordpress.com/2020/12/image-3.png?w=976" width=auto alt></p><p>Add a new trigger to begin the task on a schedule. Input your desired start date, reoccurence period, and ensure &ldquo;Enabled&rdquo; is checked, then click OK.</p><p>Move to the Actions tab.</p><p><img src="https://audiomgtmoregame.files.wordpress.com/2020/12/image-4.png?w=972" width=auto alt></p><p>Make the action &ldquo;Start a program&rdquo; and in the Program/script field, paste the path to PowerShell:</p><p>%SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe</p><p>In the Add arguments field, add the following:</p><p>-file scriptpath</p><p>where scriptpath is the path to where you saved your script earlier. My example looked like this:</p><p>-file C:\ScheduledTasks\chocolatey-updates.ps1</p><p>When done, click OK on all remaining Task Scheduler windows and the task will be scheduled. Now, as long as your computer is on, you leave the task scheduled, and the script is available where you saved it, your computer should automatically update your specified programs without you having to do anything at all.</p><p>I have been keeping my computers up to date like this for several years (set to automatically update everything weekly) and it saves me tons of time, and I rarely get notifications about new versions or annoying popups anymore.</p><a href=#bringing-it-all-together><h2 id=bringing-it-all-together><span class=hanchor arialabel=Anchor></span>Bringing it all together</h2></a><p>In this process, we installed Chocolately package manager, figured out what programs we wanted to keep up to date that were available through Chocolatey, installed those programs, wrote the update script/command, and scheduled PowerShell to run that command at a regular interval.</p><p>How did this go for you? Got any other neat tips and tricks for keeping your system running in great shape? I&rsquo;d love for you to share them in the comments.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/toc/ data-ctx="Keeping software up to date using Chocolatey" data-src=/toc class=internal-link>Table of Contents</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://blog.griff.systems/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Barker, Griffeth using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://blog.griff.systems/>Home</a></li><li><a href=https://mastodon.social/@kalipike>Follow me on Mastodon</a></li><li><a href=https://matrix.to/#/@kalipike:matrix>Chat with me on Matrix</a></li></ul></footer></div></div></body></html>